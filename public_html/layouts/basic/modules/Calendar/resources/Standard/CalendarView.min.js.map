{"version":3,"file":"CalendarView.min.js","sources":["CalendarView.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n\"use strict\";\n\n/**\n *  Class representing a standard calendar.\n * @extends Calendar_Js\n */\nwindow.Calendar_Calendar_Js = class extends Calendar_Js {\n  constructor(container, readonly) {\n    super(container, readonly);\n    this.eventCreate = app.getMainParams(\"eventCreate\");\n  }\n  setCalendarModuleOptions() {\n    let self = this,\n      options = {\n        selectable: self.eventCreate,\n        select: function(start, end) {\n          self.selectDays(start, end);\n          self.getCalendarView().fullCalendar(\"unselect\");\n        },\n        eventClick: function(calEvent, jsEvent, view) {\n          jsEvent.preventDefault();\n          var link = new URL($(this)[0].href);\n          var progressInstance = jQuery.progressIndicator({\n            blockInfo: { enabled: true }\n          });\n          var url =\n            \"index.php?module=Calendar&view=ActivityStateModal&record=\" +\n            link.searchParams.get(\"record\");\n          var callbackFunction = function(data) {\n            progressInstance.progressIndicator({ mode: \"hide\" });\n          };\n          var modalWindowParams = {\n            url: url,\n            cb: callbackFunction\n          };\n          app.showModalWindow(modalWindowParams);\n        }\n      };\n    return options;\n  }\n\n  getValuesFromSelect2(element, data, text) {\n    if (element.hasClass(\"select2-hidden-accessible\")) {\n      var types = element.select2(\"data\");\n      for (var i = 0; i < types.length; i++) {\n        if (text) {\n          data.push(types[i].text);\n        } else {\n          data.push(types[i].id);\n        }\n      }\n    }\n    return data;\n  }\n\n  getDefaultParams() {\n    let parentParams = super.getDefaultParams(),\n      users = app.moduleCacheGet(\"calendar-groups\") || [],\n      filters = [];\n    $(\".calendarFilters .filterField\").each(function() {\n      let element = $(this),\n        name,\n        value;\n      if (element.attr(\"type\") == \"checkbox\") {\n        name = element.val();\n        value = element.prop(\"checked\") ? 1 : 0;\n      } else {\n        name = element.attr(\"name\");\n        value = element.val();\n      }\n      filters.push({ name: name, value: value });\n    });\n    let params = {\n      time: app.getMainParams(\"showType\"),\n      filters: filters\n    };\n    if (users.length) {\n      params.user = parentParams.user.concat(users);\n      params.emptyFilters = false;\n    }\n    params = Object.assign(parentParams, params);\n    return params;\n  }\n\n  selectDays(startDate, endDate) {\n    var thisInstance = this;\n    var start_hour = app.getMainParams(\"startHour\");\n    var end_hour = app.getMainParams(\"endHour\");\n    if (endDate.hasTime() == false) {\n      endDate.add(-1, \"days\");\n    }\n    startDate = startDate.format();\n    endDate = endDate.format();\n    var view = thisInstance.getCalendarView().fullCalendar(\"getView\");\n    if (start_hour == \"\") {\n      start_hour = \"00\";\n    }\n    if (end_hour == \"\") {\n      end_hour = \"00\";\n    }\n    this.getCalendarCreateView().done(function(data) {\n      if (data.length <= 0) {\n        return;\n      }\n      if (view.name != \"agendaDay\" && view.name != \"agendaWeek\") {\n        startDate = startDate + \"T\" + start_hour + \":00\";\n        endDate = endDate + \"T\" + start_hour + \":00\";\n        if (startDate == endDate) {\n          let activityType = data.find('[name=\"activitytype\"]').val();\n          let activityDurations = JSON.parse(\n            data.find('[name=\"defaultOtherEventDuration\"]').val()\n          );\n          let minutes = 0;\n          for (let i in activityDurations) {\n            if (activityDurations[i].activitytype === activityType) {\n              minutes = parseInt(activityDurations[i].duration);\n              break;\n            }\n          }\n          endDate = moment(endDate)\n            .add(minutes, \"minutes\")\n            .toISOString();\n        }\n      }\n      var dateFormat = data\n        .find('[name=\"date_start\"]')\n        .data(\"dateFormat\")\n        .toUpperCase();\n      var timeFormat = data.find('[name=\"time_start\"]').data(\"format\");\n      if (timeFormat == 24) {\n        var defaultTimeFormat = \"HH:mm\";\n      } else {\n        defaultTimeFormat = \"hh:mm A\";\n      }\n      var startDateString = moment(startDate).format(dateFormat);\n      var startTimeString = moment(startDate).format(defaultTimeFormat);\n      var endDateString = moment(endDate).format(dateFormat);\n      var endTimeString = moment(endDate).format(defaultTimeFormat);\n\n      data.find('[name=\"date_start\"]').val(startDateString);\n      data.find('[name=\"due_date\"]').val(endDateString);\n      data.find('[name=\"time_start\"]').val(startTimeString);\n      data.find('[name=\"time_end\"]').val(endTimeString);\n\n      var headerInstance = new Vtiger_Header_Js();\n      headerInstance.handleQuickCreateData(data, {\n        callbackFunction: function(data) {\n          thisInstance.addCalendarEvent(data.result);\n        }\n      });\n    });\n  }\n\n  isNewEventToDisplay(eventObject) {\n    if (super.isNewEventToDisplay(eventObject)) {\n      let taskstatus = $.inArray(eventObject.activitystatus.value, [\n        \"PLL_POSTPONED\",\n        \"PLL_CANCELLED\",\n        \"PLL_COMPLETED\"\n      ]);\n      var state = $(\".fc-toolbar .js-switch--label-on\")\n        .last()\n        .hasClass(\"active\");\n      if (\n        (state === true && taskstatus >= 0) ||\n        (state != true && taskstatus == -1)\n      ) {\n        return false;\n      } else {\n        return true;\n      }\n    } else {\n      return false;\n    }\n  }\n\n  getCalendarCreateView() {\n    var thisInstance = this;\n    var aDeferred = jQuery.Deferred();\n\n    if (this.calendarCreateView !== false) {\n      aDeferred.resolve(this.calendarCreateView.clone(true, true));\n      return aDeferred.promise();\n    }\n    var progressInstance = jQuery.progressIndicator({\n      blockInfo: { enabled: true }\n    });\n    this.loadCalendarCreateView()\n      .done(function(data) {\n        progressInstance.progressIndicator({ mode: \"hide\" });\n        thisInstance.calendarCreateView = data;\n        aDeferred.resolve(data.clone(true, true));\n      })\n      .fail(function(error) {\n        progressInstance.progressIndicator({ mode: \"hide\" });\n        console.error(error);\n      });\n    return aDeferred.promise();\n  }\n\n  loadCalendarCreateView() {\n    var aDeferred = jQuery.Deferred();\n    var moduleName = app.getModuleName();\n    var url = \"index.php?module=\" + moduleName + \"&view=QuickCreateAjax\";\n    var headerInstance = Vtiger_Header_Js.getInstance();\n    headerInstance\n      .getQuickCreateForm(url, moduleName)\n      .done(function(data) {\n        aDeferred.resolve(jQuery(data));\n      })\n      .fail(function() {\n        aDeferred.reject();\n      });\n    return aDeferred.promise();\n  }\n\n  switchTpl(on, off, state) {\n    return `<div class=\"btn-group btn-group-toggle js-switch c-calendar-switch\" data-toggle=\"buttons\">\n\t\t\t\t\t<label class=\"btn btn-outline-primary c-calendar-switch__button js-switch--label-on ${\n            state ? \"\" : \"active\"\n          }\">\n\t\t\t\t\t\t<input type=\"radio\" name=\"options\" data-on-text=\"${on}\" autocomplete=\"off\" ${\n      state ? \"\" : \"checked\"\n    }>\n\t\t\t\t\t\t${on}\n\t\t\t\t\t</label>\n\t\t\t\t\t<label class=\"btn btn-outline-primary c-calendar-switch__button ${\n            state ? \"active\" : \"\"\n          }\">\n\t\t\t\t\t\t<input type=\"radio\" name=\"options\" data-off-text=\"${off}\" autocomplete=\"off\" ${\n      state ? \"checked\" : \"\"\n    }>\n\t\t\t\t\t\t${off}\n\t\t\t\t\t</label>\n\t\t\t\t</div>`;\n  }\n\n  registerSwitchEvents() {\n    const calendarview = this.getCalendarView();\n    let switchHistory,\n      switchAllDays,\n      switchContainer = $(\n        `<div class=\"js-calendar-switch-container\"></div>`\n      ).insertAfter(calendarview.find(\".fc-center\"));\n    if (\n      app.getMainParams(\"showType\") == \"current\" &&\n      app.moduleCacheGet(\"defaultShowType\") != \"history\"\n    ) {\n      switchHistory = false;\n    } else {\n      switchHistory = true;\n    }\n    $(\n      this.switchTpl(\n        app.vtranslate(\"JS_TO_REALIZE\"),\n        app.vtranslate(\"JS_HISTORY\"),\n        switchHistory\n      )\n    )\n      .prependTo(switchContainer)\n      .on(\"change\", \"input\", e => {\n        const currentTarget = $(e.currentTarget);\n        if (typeof currentTarget.data(\"on-text\") !== \"undefined\") {\n          app.setMainParams(\"showType\", \"current\");\n          app.moduleCacheSet(\"defaultShowType\", \"current\");\n        } else if (typeof currentTarget.data(\"off-text\") !== \"undefined\") {\n          app.setMainParams(\"showType\", \"history\");\n          app.moduleCacheSet(\"defaultShowType\", \"history\");\n        }\n        this.loadCalendarData();\n      });\n    if (\n      app.getMainParams(\"switchingDays\") === \"workDays\" &&\n      app.moduleCacheGet(\"defaultSwitchingDays\") !== \"all\"\n    ) {\n      switchAllDays = false;\n    } else {\n      switchAllDays = true;\n    }\n    if (app.getMainParams(\"hiddenDays\", true) !== false) {\n      $(\n        this.switchTpl(\n          app.vtranslate(\"JS_WORK_DAYS\"),\n          app.vtranslate(\"JS_ALL\"),\n          switchAllDays\n        )\n      )\n        .prependTo(switchContainer)\n        .on(\"change\", \"input\", e => {\n          const currentTarget = $(e.currentTarget);\n          let hiddenDays = [];\n          if (typeof currentTarget.data(\"on-text\") !== \"undefined\") {\n            app.setMainParams(\"switchingDays\", \"workDays\");\n            app.moduleCacheSet(\"defaultSwitchingDays\", \"workDays\");\n            hiddenDays = app.getMainParams(\"hiddenDays\", true);\n          } else if (typeof currentTarget.data(\"off-text\") !== \"undefined\") {\n            app.setMainParams(\"switchingDays\", \"all\");\n            app.moduleCacheSet(\"defaultSwitchingDays\", \"all\");\n          }\n          calendarview.fullCalendar(\"option\", \"hiddenDays\", hiddenDays);\n          this.registerSwitchEvents();\n          this.loadCalendarData();\n        });\n    }\n  }\n\n  registerCacheSettings() {\n    var thisInstance = this;\n    var calendar = thisInstance.getCalendarView();\n    if (app.moduleCacheGet(\"defaultSwitchingDays\") == \"all\") {\n      app.setMainParams(\"switchingDays\", \"all\");\n    } else {\n      app.setMainParams(\"switchingDays\", \"workDays\");\n    }\n    if (app.moduleCacheGet(\"defaultShowType\") == \"history\") {\n      app.setMainParams(\"showType\", \"history\");\n    } else {\n      app.setMainParams(\"showType\", \"current\");\n    }\n    $(\".siteBarRight .filterField\").each(function(index) {\n      var name = $(this).attr(\"id\");\n      var value = app.moduleCacheGet(name);\n      var element = $(\"#\" + name);\n      if (element.length > 0 && value != null) {\n        if (element.attr(\"type\") == \"checkbox\") {\n          element.prop(\"checked\", value);\n        }\n      }\n    });\n    calendar.find(\".fc-toolbar .fc-button\").on(\"click\", function(e) {\n      let view;\n      let element = $(e.currentTarget);\n      view = calendar.fullCalendar(\"getView\");\n      if (element.hasClass(\"fc-\" + view.name + \"-button\")) {\n        app.moduleCacheSet(\"defaultView\", view.name);\n      } else if (\n        element.hasClass(\"fc-prev-button\") ||\n        element.hasClass(\"fc-next-button\") ||\n        element.hasClass(\"fc-today-button\")\n      ) {\n        app.moduleCacheSet(\"start\", view.start.format());\n        app.moduleCacheSet(\"end\", view.end.format());\n      }\n    });\n    var keys = app.moduleCacheKeys();\n    if (keys.length > 0) {\n      var alert = $(\"#moduleCacheAlert\");\n      $(\".bodyContents\").on(\"Vtiger.Widget.Load.undefined\", function(e, data) {\n        alert.removeClass(\"d-none\");\n      });\n      alert.find(\".cacheClear\").on(\"click\", function(e) {\n        app.moduleCacheClear();\n        alert.addClass(\"d-none\");\n        location.reload();\n      });\n    }\n  }\n\n  registerEvents() {\n    super.registerEvents();\n    this.registerCacheSettings();\n    this.registerSwitchEvents();\n  }\n};\n"],"names":["window","Calendar_Calendar_Js","container","readonly","eventCreate","app","getMainParams","options","selectable","self","select","start","end","selectDays","getCalendarView","fullCalendar","eventClick","calEvent","jsEvent","preventDefault","$","href","progressInstance","jQuery","progressIndicator","blockInfo","enabled","url","link","searchParams","get","showModalWindow","cb","mode","element","data","text","hasClass","select2","i","types","length","push","id","users","moduleCacheGet","filters","each","value","attr","name","val","prop","time","params","user","parentParams","concat","emptyFilters","Object","assign","startDate","endDate","start_hour","end_hour","hasTime","add","format","thisInstance","getCalendarCreateView","done","find","activityDurations","JSON","parse","minutes","activitytype","activityType","parseInt","duration","moment","toISOString","toUpperCase","timeFormat","dateFormat","startTimeString","defaultTimeFormat","endDateString","endTimeString","startDateString","headerInstance","handleQuickCreateData","callbackFunction","addCalendarEvent","result","eventObject","inArray","activitystatus","state","last","aDeferred","Deferred","calendarCreateView","resolve","clone","promise","loadCalendarCreateView","fail","error","console","moduleName","getModuleName","Vtiger_Header_Js","getInstance","getQuickCreateForm","reject","on","off","calendarview","switchHistory","switchAllDays","switchContainer","insertAfter","switchTpl","vtranslate","prependTo","e","currentTarget","setMainParams","moduleCacheSet","loadCalendarData","hiddenDays","registerSwitchEvents","calendar","view","moduleCacheKeys","alert","removeClass","moduleCacheClear","addClass","location","reload","registerCacheSettings","Calendar_Js"],"mappings":"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"}