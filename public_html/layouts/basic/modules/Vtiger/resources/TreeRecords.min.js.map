{"version":3,"file":"TreeRecords.min.js","sources":["TreeRecords.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Vtiger_TreeRecords_Js',\n\t{},\n\t{\n\t\tmainContainer: false,\n\t\ttreeInstance: false,\n\t\ttreeData: false,\n\t\tgetContainer: function() {\n\t\t\tif (this.mainContainer == false) {\n\t\t\t\tthis.mainContainer = jQuery('#centerPanel');\n\t\t\t}\n\t\t\treturn this.mainContainer;\n\t\t},\n\t\tsetContainer: function(container) {\n\t\t\tthis.mainContainer = container;\n\t\t},\n\t\tgetTreeListValues: function(container) {\n\t\t\tif (this.treeData == false && container !== 'undefined') {\n\t\t\t\tvar treeValues = container.find('#treeListValues').val();\n\t\t\t\tif (treeValues != '') {\n\t\t\t\t\tthis.treeData = JSON.parse(treeValues);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.treeData;\n\t\t},\n\t\tgenerateTree: function(container) {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.treeInstance = container.find('#treeListContents');\n\t\t\tthisInstance.treeInstance.jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tdata: thisInstance.getTreeListValues(container),\n\t\t\t\t\tthemes: {\n\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tplugins: ['checkbox']\n\t\t\t});\n\t\t},\n\t\tgetRecordsParams: function(container) {\n\t\t\tlet selected = [];\n\t\t\t$.each(this.treeInstance.jstree('get_selected', true), function(index, value) {\n\t\t\t\tselected.push(value.original.record_id);\n\t\t\t});\n\t\t\treturn {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: app.getViewName(),\n\t\t\t\tbranches: selected,\n\t\t\t\tfilter: container.find('#moduleFilter').val()\n\t\t\t};\n\t\t},\n\t\tgetRecordsList: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = thisInstance.getContainer();\n\t\t\tvar progressIndicator = jQuery.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\tblockInfo: { enabled: true }\n\t\t\t});\n\n\t\t\t$.extend($.fn.dataTable.defaults, {\n\t\t\t\tlanguage: {\n\t\t\t\t\tsLengthMenu: app.vtranslate('JS_S_LENGTH_MENU'),\n\t\t\t\t\tsZeroRecords: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfo: app.vtranslate('JS_S_INFO'),\n\t\t\t\t\tsInfoEmpty: app.vtranslate('JS_S_INFO_EMPTY'),\n\t\t\t\t\tsSearch: app.vtranslate('JS_SEARCH'),\n\t\t\t\t\tsEmptyTable: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfoFiltered: app.vtranslate('JS_S_INFO_FILTERED'),\n\t\t\t\t\tsLoadingRecords: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\tsProcessing: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\toPaginate: {\n\t\t\t\t\t\tsFirst: app.vtranslate('JS_S_FIRST'),\n\t\t\t\t\t\tsPrevious: app.vtranslate('JS_S_PREVIOUS'),\n\t\t\t\t\t\tsNext: app.vtranslate('JS_S_NEXT'),\n\t\t\t\t\t\tsLast: app.vtranslate('JS_S_LAST')\n\t\t\t\t\t},\n\t\t\t\t\toAria: {\n\t\t\t\t\t\tsSortAscending: app.vtranslate('JS_S_SORT_ASCENDING'),\n\t\t\t\t\t\tsSortDescending: app.vtranslate('JS_S_SORT_DESCENDING')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tAppConnector.request(thisInstance.getRecordsParams(container))\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tcontainer.find('#recordsListContents').html(data);\n\t\t\t\t\tcontainer.find('#recordsListContents table').dataTable();\n\n\t\t\t\t\tprogressIndicator.progressIndicator({ mode: 'hide' });\n\t\t\t\t})\n\t\t\t\t.fail(function(error) {\n\t\t\t\t\tprogressIndicator.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t},\n\t\tregisterFilterChangeEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('change', '#moduleFilter', function(e) {\n\t\t\t\tthisInstance.getRecordsList();\n\t\t\t});\n\t\t},\n\t\tregisterSelectBrancheEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.treeInstance.on('changed.jstree', function(e, data) {\n\t\t\t\tthisInstance.getRecordsList();\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function() {\n\t\t\tvar container = this.getContainer();\n\t\t\tthis.generateTree(container);\n\t\t\tthis.registerFilterChangeEvent(container);\n\t\t\tthis.registerSelectBrancheEvent(container);\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","mainContainer","treeInstance","treeData","getContainer","setContainer","container","getTreeListValues","find","val","JSON","parse","treeValues","generateTree","thisInstance","jstree","core","data","themes","name","responsive","plugins","getRecordsParams","each","index","value","selected","push","original","record_id","module","app","getModuleName","view","getViewName","branches","filter","getRecordsList","progressIndicator","message","vtranslate","blockInfo","enabled","$","extend","fn","dataTable","defaults","language","sLengthMenu","sZeroRecords","sInfo","sInfoEmpty","sSearch","sEmptyTable","sInfoFiltered","sLoadingRecords","sProcessing","oPaginate","sFirst","sPrevious","sNext","sLast","oAria","sSortAscending","sSortDescending","AppConnector","request","done","html","mode","fail","registerFilterChangeEvent","on","registerSelectBrancheEvent","registerEvents"],"mappings":"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"}