'use strict';

$.Class('Settings_WebserviceApps_Index_Js',{},{getContainer:function getContainer(){return this.container},registerTableEvents:function registerTableEvents(){var thisInstance=this,container=this.container=$('.configContainer');container.find('.edit').on('click',function(e){var currentTarget=$(e.currentTarget),trRow=currentTarget.closest('tr');thisInstance.showFormToEditKey(trRow.data('id'));}),container.find('.remove').on('click',function(e){var removeButton=jQuery(e.currentTarget),currentTrElement=removeButton.closest('tr'),message=app.vtranslate('JS_DELETE_CONFIRMATION');Vtiger_Helper_Js.showConfirmationBox({message:message}).done(function(){var params={module:app.getModuleName(),parent:app.getParentModuleName(),action:'Delete',id:currentTrElement.data('id')},progress=jQuery.progressIndicator();AppConnector.request(params).done(function(){progress.progressIndicator({mode:'hide'}),thisInstance.loadTable();});});});},loadTable:function loadTable(){var thisInstance=this,params={module:app.getModuleName(),parent:app.getParentModuleName(),view:'Index'},progress=jQuery.progressIndicator();AppConnector.request(params).done(function(data){progress.progressIndicator({mode:'hide'}),$('.configContainer').html(data),thisInstance.registerTableEvents();});},showFormToEditKey:function showFormToEditKey(id){var thisInstance=this,params={module:app.getModuleName(),parent:app.getParentModuleName(),view:'CreateApp'};''!=id&&(params.record=id);var progress=jQuery.progressIndicator();AppConnector.request(params).done(function(data){progress.progressIndicator({mode:'hide'}),app.showModalWindow(data,function(container){var prevButton=container.find('.previewPassword'),password=container.find('[name="pass"]');prevButton.on('mousedown',function(){password.attr('type','text');}),prevButton.on('mouseup',function(){password.attr('type','password');}),prevButton.on('mouseout',function(){password.attr('type','password');});var clipboard=App.Fields.Text.registerCopyClipboard(container,'.copyPassword');container.one('hidden.bs.modal',function(){clipboard.destroy();});var form=container.find('form');form.validationEngine(app.validationEngineOptions),container.find('[name="saveButton"]').on('click',function(){if(form.validationEngine('validate')){var params={module:app.getModuleName(),parent:app.getParentModuleName(),action:'SaveAjax',name:container.find('[name="name"]').val(),url:container.find('[name="addressUrl"]').val(),status:container.find('[name="status"]').is(':checked'),type:container.find('.typeServer').val(),pass:password.val()};''!=id&&(params.id=id),AppConnector.request(params).done(function(data){!0===data.result?(thisInstance.loadTable(),app.hideModalWindow()):'undefined'!=typeof data.result.error&&Vtiger_Helper_Js.showPnotify(data.result.error);});}});});});},registerAddButton:function registerAddButton(){var thisInstance=this;$('.createKey').on('click',function(){thisInstance.showFormToEditKey();});},registerEvents:function registerEvents(){this.registerAddButton(),this.registerTableEvents(),App.Fields.Text.registerCopyClipboard(this.getContainer());}});
//# sourceMappingURL=WebserviceApps.min.js.map
