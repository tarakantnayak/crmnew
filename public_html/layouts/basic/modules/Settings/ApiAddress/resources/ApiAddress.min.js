'use strict';

var defineProperty = function (obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
};

jQuery.Class('Settings_ApiAddress_Configuration_Js',{},{registerSave:function registerSave(content){content.find('.saveGlobal').on('click',function(){var defaultProvider=$('[name="default_provider"]:checked'),elements={global:{min_length:$('[name="min_length"]').val(),result_num:$('[name="result_num"]').val(),default_provider:defaultProvider.length?defaultProvider.val():0}};$('[name="active"]').each(function(i,e){elements[e.dataset.type]={active:e.checked?1:0};}),AppConnector.request({data:{module:'ApiAddress',parent:'Settings',action:'SaveConfig',elements:elements},async:!1,dataType:'json'}).done(function(data){Vtiger_Helper_Js.showPnotify({text:data.result.message,type:'success'});}).fail(function(){Vtiger_Helper_Js.showPnotify({text:app.vtranslate('JS_ERROR'),type:'error'});});});},registerValidate:function registerValidate(elements){return !0},registerValidatemin_length:function registerValidatemin_length(val){var filter=/^\d+$/;if(!filter.test(val)||1==val||0==val){var par={text:app.vtranslate('JS_WRONG_NUMBER'),type:'error'};return Vtiger_Helper_Js.showPnotify(par),!1}return !0},registerValidatekey:function registerValidatekey(val,apiName){var status=!0;if('opencage_data'==apiName){jQuery.ajax({url:'https://api.opencagedata.com/geocode/v1/json?query=test&pretty=1&key='+val,async:!1,complete:function complete(data){if(403==data.status){var parametry={text:app.vtranslate('Invalid API key'),type:'error'};Vtiger_Helper_Js.showPnotify(parametry),status=!1;}}});}else return !0;return status},registerConfigModal:function registerConfigModal(container){container.find('.js-show-config-modal').on('click',function(e){var providerName=e.currentTarget.dataset.provider;app.showModalWindow(null,'index.php?module=ApiAddress&parent=Settings&view=ApiConfigModal&provider='+providerName,function(modalContainer){modalContainer.find('.js-modal__save').on('click',function(){var elements={},customField=modalContainer.find('.js-custom-field');customField.each(function(i,e){elements[$(e).attr('name')]=e.value;}),elements=defineProperty({},providerName,elements),AppConnector.request({data:{module:'ApiAddress',parent:'Settings',action:'SaveConfig',elements:elements},async:!1,dataType:'json'}).done(function(data){Vtiger_Helper_Js.showPnotify({text:data.result.message,type:'success'}),window.location.reload();}).fail(function(){Vtiger_Helper_Js.showPnotify({text:app.vtranslate('JS_ERROR'),type:'error'});});});});});},registerEvents:function registerEvents(){var content=$('.contentsDiv'),configTable=$('.js-config-table');this.registerConfigModal(configTable),this.registerSave(content);}});
//# sourceMappingURL=ApiAddress.min.js.map
