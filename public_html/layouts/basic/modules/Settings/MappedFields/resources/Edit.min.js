'use strict';

Settings_Vtiger_Edit_Js('Settings_MappedFields_Edit_Js',{instance:{}},{currentInstance:!1,editContainer:!1,init:function init(){this.initiate();},getContainer:function getContainer(){return this.editContainer},setContainer:function setContainer(element){return this.editContainer=element,this},getInstance:function getInstance(step){if(step in Settings_MappedFields_Edit_Js.instance)return Settings_MappedFields_Edit_Js.instance[step];return Settings_MappedFields_Edit_Js.instance[step]=new window['Settings_MappedFields_Edit'+step+'_Js'],Settings_MappedFields_Edit_Js.instance[step]},getStepValue:function getStepValue(){var container=this.currentInstance.getContainer();return jQuery('.step',container).val()},initiate:function initiate(container){'undefined'==typeof container&&(container=jQuery('.mfTemplateContents')),container.is('.mfTemplateContents')?this.setContainer(container):this.setContainer(jQuery('.mfTemplateContents',container)),this.initiateStep('1'),this.currentInstance.registerEvents();},initiateStep:function initiateStep(stepVal){this.activateHeader('step'+stepVal),this.currentInstance=this.getInstance(stepVal);},activateHeader:function activateHeader(step){var headersContainer=jQuery('.crumbs ');headersContainer.find('.active').removeClass('active'),jQuery('#'+step,headersContainer).addClass('active');},registerFormSubmitEvent:function registerFormSubmitEvent(form){var thisInstance=this;jQuery.isFunction(thisInstance.currentInstance.submit)&&form.on('submit',function(e){var form=jQuery(e.currentTarget),specialValidation=!0;jQuery.isFunction(thisInstance.currentInstance.isFormValidate)&&(specialValidation=thisInstance.currentInstance.isFormValidate()),form.validationEngine('validate')&&specialValidation&&thisInstance.currentInstance.submit().done(function(data){if(data){thisInstance.getContainer().append(data);var stepVal=thisInstance.getStepValue(),nextStepVal=parseInt(stepVal)+1;thisInstance.initiateStep(nextStepVal),thisInstance.currentInstance.initialize();var container=thisInstance.currentInstance.getContainer();thisInstance.registerFormSubmitEvent(container),thisInstance.currentInstance.registerEvents();}}),e.preventDefault();});},back:function back(){var step=this.getStepValue(),prevStep=parseInt(step)-1;this.currentInstance.initialize();var container=this.currentInstance.getContainer(),mfRecordElement=jQuery('[name="record"]',container),mfId=mfRecordElement.val();container.remove(),this.initiateStep(prevStep);var currentContainer=this.currentInstance.getContainer();currentContainer.show(),jQuery('[name="record"]',currentContainer).val(mfId);},registerCancelStepClickEvent:function registerCancelStepClickEvent(form){jQuery('button.cancelLink',form).on('click',function(){window.history.back();});},registerBackStepClickEvent:function registerBackStepClickEvent(){var thisInstance=this,container=this.getContainer();container.on('click','.backStep',function(){thisInstance.back();});},registerEvents:function registerEvents(){var form=this.currentInstance.getContainer();this.registerFormSubmitEvent(form),this.registerBackStepClickEvent(),this.registerCancelStepClickEvent(form);}});
//# sourceMappingURL=Edit.min.js.map
