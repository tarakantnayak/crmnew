'use strict';

Settings_Workflows_Edit_Js("Settings_Workflows_Edit2_Js",{},{step2Container:!1,advanceFilterInstance:!1,init:function init(){this.initialize();},getContainer:function getContainer(){return this.step2Container},setContainer:function setContainer(element){return this.step2Container=element,this},initialize:function initialize(container){"undefined"==typeof container&&(container=jQuery("#workflow_step2")),container.is("#workflow_step2")?this.setContainer(container):this.setContainer(jQuery("#workflow_step2"));},calculateValues:function calculateValues(){var enableFilterElement=jQuery("#enableAdvanceFilters");if(0<enableFilterElement.length&&!1==enableFilterElement.is(":checked"))jQuery("#advanced_filter").val(jQuery("#olderConditions").val());else{jQuery("[name=\"filtersavedinnew\"]").val("6");var advfilterlist=this.advanceFilterInstance.getValues();jQuery("#advanced_filter").val(JSON.stringify(advfilterlist));}},submit:function submit(){var aDeferred=jQuery.Deferred(),form=this.getContainer();this.calculateValues();var formData=form.serializeFormData(),progressIndicatorElement=jQuery.progressIndicator({position:"html",blockInfo:{enabled:!0}});return AppConnector.request(formData).done(function(data){if(form.hide(),data.result){Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate("JS_WORKFLOW_SAVED_SUCCESSFULLY")});var workflowRecordElement=jQuery("[name=\"record\"]",form);""==workflowRecordElement.val()&&workflowRecordElement.val(data.result.id);var params={module:app.getModuleName(),parent:app.getParentModuleName(),view:"Edit",mode:"step3",record:data.result.id};AppConnector.request(params).done(function(data){aDeferred.resolve(data);});}progressIndicatorElement.progressIndicator({mode:"hide"});}),aDeferred.promise()},registerEnableFilterOption:function registerEnableFilterOption(){jQuery("[name=\"conditionstype\"]").on("change",function(e){var advanceFilterContainer=jQuery("#advanceFilterContainer"),currentRadioButtonElement=jQuery(e.currentTarget);currentRadioButtonElement.hasClass("recreate")?currentRadioButtonElement.is(":checked")&&advanceFilterContainer.removeClass("zeroOpacity"):advanceFilterContainer.addClass("zeroOpacity");});},registerEvents:function registerEvents(){var opts=app.validationEngineOptions;opts.onValidationComplete=function(form,valid){return valid},opts.promptPosition="bottomRight",jQuery("#workflow_step2").validationEngine(opts);var container=this.getContainer();jQuery("button[type=\"submit\"]",container).on("click",function(){for(var fieldUiHolders=jQuery(".fieldUiHolder"),i=0;i<fieldUiHolders.length;i++){var fieldUiHolder=fieldUiHolders[i],fieldValueElement=jQuery(".getPopupUi",fieldUiHolder),valueType=jQuery("[name=\"valuetype\"]",fieldUiHolder).val();"rawtext"!=valueType&&(fieldValueElement.removeAttr("data-validation-engine"),fieldValueElement.removeClass("validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]"));}}),App.Fields.Picklist.changeSelectElementView(container),this.advanceFilterInstance=Vtiger_AdvanceFilter_Js.getInstance(jQuery(".filterContainer",container)),this.getPopUp(),"5"==jQuery("[name=\"filtersavedinnew\"]",container).val()&&this.registerEnableFilterOption();}});
//# sourceMappingURL=Edit2.min.js.map
